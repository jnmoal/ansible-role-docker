stages:
  - test

before_script:
  - vagrant plugin install vagrant-vbguest

test_fedora:
  stage: test
  script:
    - vagrant up fedora
    - vagrant ssh fedora -c "ansible-playbook /vagrant/tests/test.yml -c local --skip-tags checks"
    - vagrant ssh fedora -c "ansible-playbook /vagrant/tests/test.yml -c local --tags checks"
  after_script:
    - vagrant destroy -f fedora

test_debian:
  stage: test
  script:
    - vagrant up debian
    - vagrant ssh debian -c "ansible-playbook /vagrant/tests/test.yml -c local --skip-tags checks"
    - vagrant ssh debian -c "ansible-playbook /vagrant/tests/test.yml -c local --tags checks"
  after_script:
    - vagrant destroy -f debian
